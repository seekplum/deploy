---
- name: update bash_profile configuare
  lineinfile:
    dest: "{{HOME_ROOT}}/.bash_profile"
    state: absent
    regexp: "{{item}}"
  with_items:
    - 'export NVM_DIR='
    - '"\$NVM_DIR/nvm.sh"'
    - '"\$NVM_DIR/bash_completion"'
  tags:
    - nodejs

- name: install nodejs
  block:
    - name: clean nvm
      file:
        path: "{{HOME_ROOT}}/.nvm"
        state: absent

    - name: create nvm dir
      file:
        dest: "{{HOME_ROOT}}/.nvm"
        state: directory
        mode: 0755

    - name: install npm
      shell: curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh | bash

    - name: install nodejs
      shell: "source {{HOME_ROOT}}/.bash_profile && nvm install v11.4.0"
  tags:
    - nodejs
